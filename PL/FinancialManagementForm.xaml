<Window x:Class="Heyam.FinancialManagementForm"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:hc="https://handyorg.github.io/handycontrol"
        xmlns:lvc="clr-namespace:LiveCharts.Wpf;assembly=LiveCharts.Wpf"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:local="clr-namespace:Heyam"
        mc:Ignorable="d"
        ResizeMode="NoResize"
        WindowStyle="None"
        WindowStartupLocation="CenterScreen"
        AllowsTransparency="True"
        Title="FinancialManagementForm" Height="660" Width="950" FontFamily="pack://application:,,,/Resources/Fonts/#IRANSansWeb(FaNum)" FlowDirection="RightToLeft">
    <Border x:Name="border" BorderBrush="#2A2929" BorderThickness="5" CornerRadius="5">
        <Grid>
            <!-- Header -->
            <Border Background="#1259D5" Height="50" VerticalAlignment="Top">
                <TextBlock Text="سیستم امور مالی و حسابداری" Foreground="White" FontSize="24" FontWeight="Bold" VerticalAlignment="Center" HorizontalAlignment="Center" />
            </Border>
            <!-- پاپ‌آپ و نمایش جزئیات -->
            <Grid x:Name="AddPaymentPopup" Visibility="Collapsed"
            Height="500"
            Width="900"
            Grid.Row="1" HorizontalAlignment="Center" Margin="0 -75 0 0" Panel.ZIndex="99">
                <Border Background="White" Padding="15" CornerRadius="10" BorderBrush="Black" BorderThickness="3" Width="800" Height="480">
                    <!-- Form for Adding Payment -->
                    <GroupBox Header="ثبت پرداخت" Background="White" BorderBrush="#ccc" BorderThickness="1">
                        <Grid x:Name="RegPaymentPanel" Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <WrapPanel>
                                <TextBlock Text="نام موکل:" Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" Margin="5"/>
                                <ComboBox x:Name="SelectClientNameCB" IsEditable="True" Grid.Row="0" Grid.Column="1" Height="30" Width="180" SelectionChanged="SelectClientNameCB_SelectionChanged" />
                                <TextBlock Text="پرونده مربوطه:" Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" Margin="5"/>
                                <ComboBox x:Name="SelectCaseNumberCB" IsEditable="True" Grid.Row="0" Grid.Column="1" Height="30" Width="180" />
                                <TextBlock Text="خدمات:" Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" Margin="5"/>
                                <ComboBox x:Name="ServiceCB" Cursor="Hand" Grid.Row="0" Grid.Column="1" Height="30" Width="170">
                                    <ComboBoxItem Cursor="Hand" Content="مشاوره"/>
                                    <ComboBoxItem Cursor="Hand" Content="حق الوکاله"/>
                                </ComboBox>
                            </WrapPanel>
                            <WrapPanel Margin="0 40">
                                <TextBlock Text="وضعیت پرداختی:" Grid.Row="1" Grid.Column="0" VerticalAlignment="Center" Margin="5"/>
                                <ComboBox x:Name="PaymentStatusCB" Grid.Row="1" Grid.Column="0" Height="30" Width="130" SelectionChanged="PaymentStatusCB_SelectionChanged">
                                    <ComboBoxItem Content="پیش پرداخت"/>
                                    <ComboBoxItem Content="تسویه کامل"/>
                                </ComboBox>
                                <TextBlock Text="مبلغ:" Grid.Row="1" Grid.Column="0" VerticalAlignment="Center" Margin="5"/>
                                <TextBox x:Name="AmountTB" Grid.Row="1" Grid.Column="0" Height="30" Width="130" TextChanged="AmountTB_TextChanged"/>
                                <TextBlock Text="تاریخ:" Grid.Row="1" Grid.Column="0" VerticalAlignment="Center" Margin="5"/>
                                <hc:PersianDatePicker x:Name="PaymentDP" Cursor="Hand" Grid.Row="2" Grid.Column="1" Height="30" Width="130"/>
                                <!-- Payment Method -->
                                <TextBlock Text="روش:" VerticalAlignment="Center" Grid.Column="0" Grid.Row="1" Margin="5"/>
                                <ComboBox x:Name="PaymentTypeCB" Cursor="Hand" Grid.Column="0" Grid.Row="1" Height="30" Width="130" Margin="5">
                                    <ComboBoxItem Cursor="Hand" Content="کارت به کارت"/>
                                    <ComboBoxItem Cursor="Hand" Content="کارتخوان"/>
                                    <ComboBoxItem Cursor="Hand" Content="نقدی"/>
                                    <ComboBoxItem Cursor="Hand" Content="چک"/>
                                    <ComboBoxItem Cursor="Hand" Content="ارز خارجی"/>
                                </ComboBox>
                            </WrapPanel>
                            <WrapPanel Margin="0,90,0,0" >
                                <TextBlock Text="توضیحات:" Grid.Row="2" Grid.Column="0" VerticalAlignment="Center" Margin="5 20"/>
                                <TextBox x:Name="DescriptionTB" VerticalContentAlignment="Top" VerticalScrollBarVisibility="Auto" Grid.Row="2" Grid.Column="0" Height="90" TextWrapping="Wrap" AcceptsReturn="True" Width="650"/>
                            </WrapPanel>
                            <WrapPanel Margin="-100 200">
                                <TextBlock Text="فیش های پرداختی موکل:" VerticalAlignment="Center" Margin="100 0 0 150" FontSize="11.5" Foreground="#555" />
                                <!-- بخش مدیریت اسناد -->
                                <Grid FlowDirection="LeftToRight" Grid.Row="3" Grid.Column="0" VerticalAlignment="Center" Width="555" Margin="-100 0 0 0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <Border x:Name="DropBoxDocuments" Height="90"             
                                        BorderBrush="#0078D7"
                                        BorderThickness="2"
                                        CornerRadius="10"
                                        Background="#E6F4FF"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"                                            
                                        Width="400"                  
                                        AllowDrop="True"    
                                        DragEnter="DropBoxDocuments_DragEnter"
                                        DragLeave="DropBoxDocuments_DragLeave"
                                        Drop="DropBoxDocuments_Drop">
                                        <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled" Margin="-2,0,-2,-2">
                                            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Stretch">
                                                <TextBlock Text="برای آپلود، فایل‌ها را اینجا بکشید و رها کنید" 
                                                  FontSize="14" Foreground="Gray" HorizontalAlignment="Center" />
                                                <!-- Uploaded Files -->
                                                <ListBox x:Name="FilesList" SelectionMode="Single" BorderThickness="0" Background="Transparent" Margin="5" SelectionChanged="FilesList_SelectionChanged"  VerticalContentAlignment="Top">
                                                    <ListBox.ItemTemplate>
                                                        <DataTemplate>
                                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Stretch" Margin="5,2">
                                                                <TextBlock Text="{Binding FileName}" FontSize="10" VerticalAlignment="Center" Width="250" Margin="5,0"/>
                                                                <Button Content="حذف" Cursor="Hand" Width="80" Margin="5,0" Click="DeleteFile_Click" Tag="{Binding}"/>
                                                            </StackPanel>
                                                        </DataTemplate>
                                                    </ListBox.ItemTemplate>
                                                </ListBox>
                                            </StackPanel>
                                        </ScrollViewer>
                                    </Border>
                                    <StackPanel Grid.Column="2">
                                        <Button x:Name="AddDocBTN" Content="افزودن" Cursor="Hand" Width="90" Margin="0 5 -10 0" Click="AddDocBTN_Click" Height="34"  />
                                        <!--Click="AddDocument_Click"-->
                                        <Button x:Name="ShowDocBTN" Content="مشاهده فایل" Cursor="Hand" Width="90" Margin="0 10 -10 0" IsEnabled="False" Click="ShowFile_Click" Height="34" />
                                        <!--Click="RemoveDocument_Click"-->
                                    </StackPanel>
                                </Grid>
                            </WrapPanel>
                            <!-- Reminder -->
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0 0 0 -150">
                                <CheckBox x:Name="ReminderDebtCheckBox" IsEnabled="False" Content="تنظیم یادآوری برای پرداخت بدهی موکل" Cursor="Hand" FontSize="13" Margin="0,0,10,0" Checked="ReminderDebtCheckBox_Checked" Unchecked="ReminderDebtCheckBox_Unchecked"/>
                                <hc:PersianDatePicker x:Name="ReminderDP" IsEnabled="False" FontSize="14" Width="200"/>
                            </StackPanel>
                            <WrapPanel>
                                <Button x:Name="SubmitPaymentBTN" Content="ثبت پرداخت" Cursor="Hand" Height="35" Margin="560,345,0,0" Background="#4CAF50" Foreground="White" FontWeight="Bold" Click="SubmitPaymentBTN_Click"/>
                                <Button x:Name="CancelPaymentBTN" Content="لغو" Cursor="Hand" Height="35" Width="60" Margin="20,345,0,0" Background="#F44336" Foreground="White" FontWeight="Bold" Click="CancelPaymentBTN_Click"/>
                                <!--Click="SubmitPayment_Click"-->
                            </WrapPanel>
                        </Grid>
                    </GroupBox>
                </Border>
            </Grid>
            <!-- پاپ‌آپ و نمایش جزئیات -->
            <Grid x:Name="PaymentDetailsPopup" Visibility="Collapsed" Panel.ZIndex="99">
                <Border Background="White" Padding="15" CornerRadius="10" BorderBrush="Black" BorderThickness="3" Width="500" Height="500">
                    <StackPanel>
                        <TextBlock Text="📜 مشخصات پرداختی موکل" FontSize="18" FontWeight="Bold" Foreground="DarkBlue" Margin="0,0,0,10"/>
                        <WrapPanel>
                            <TextBlock Text="پرونده مربوطه:" FontWeight="Bold"/>
                            <TextBlock x:Name="ClientCaseNumberText" Text="{Binding ClientCaseNumber}" Foreground="Purple"  FontSize="14" Width="150" Margin="5 -2"/>
                            <TextBlock Text="مبلغ پرداختی:" FontWeight="Bold" Margin="0 0"/>
                            <TextBlock x:Name="AmountText" Foreground="Purple" FontSize="14" Margin="5 0" Width="150"/>
                        </WrapPanel>
                        <WrapPanel>
                            <TextBlock Text="تاریخ پرداخت:" FontWeight="Bold"/>
                            <TextBlock x:Name="PaymentDateText" Text="{Binding SetDateShamsi}" Foreground="Purple" FontSize="14" Margin="5 0" Width="150"/>
                            <TextBlock Text="روش پرداخت:" FontWeight="Bold" Margin="0 0"/>
                            <TextBlock x:Name="PaymentTypeText" Text="{Binding PaymentType}" Foreground="Purple" FontSize="14" Margin="5 0" Width="150"/>
                        </WrapPanel>
                        <WrapPanel>
                            <TextBlock Text="توضیحات:" FontWeight="Bold" Margin="0,0,0,0"/>
                            <TextBox x:Name="DescriptionText" Text="{Binding Description}" TextWrapping="Wrap" Width="432" Height="100" VerticalContentAlignment="Top" VerticalScrollBarVisibility="Visible"/>
                        </WrapPanel>
                        <WrapPanel Margin="0 0">
                            <TextBlock Text="فیش های پرداختی موکل:" VerticalAlignment="Center" Margin="0 10 0 0" FontSize="11.5" Foreground="#555" />
                            <!-- بخش مدیریت اسناد -->
                            <Grid FlowDirection="LeftToRight" Grid.Row="3" Grid.Column="0" VerticalAlignment="Center" Width="450" Margin="10 0 0 0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Border x:Name="PopupDropBoxDocuments" Height="95"             
                                     BorderBrush="#0078D7"
                                     BorderThickness="2"
                                     CornerRadius="10"
                                     Background="#E6F4FF"
                                     HorizontalAlignment="Center"
                                     VerticalAlignment="Center"                                            
                                     Width="350"                  
                                     AllowDrop="True"    
                                     DragEnter="DropBoxDocuments_DragEnter"
                                     DragLeave="DropBoxDocuments_DragLeave"
                                     Drop="DropBoxDocuments_Drop">
                                    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled" Margin="-2,0,-2,-2">
                                        <StackPanel VerticalAlignment="Center" HorizontalAlignment="Stretch">
                                            <TextBlock Text="مشاهده رسیدهای پرداختی" 
                                            FontSize="14" Foreground="Gray" HorizontalAlignment="Center" />
                                            <!-- Uploaded Files -->
                                            <ListBox x:Name="PopupFilesList" SelectionMode="Single" BorderThickness="0" Background="Transparent" Margin="5" SelectionChanged="PopupFilesList_SelectionChanged"  VerticalContentAlignment="Top">
                                                <ListBox.ItemTemplate>
                                                    <DataTemplate>
                                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Stretch" Margin="5,2">
                                                            <TextBlock Text="{Binding FileName}" FontSize="10" VerticalAlignment="Center" Width="250" Margin="5,0"/>
                                                        </StackPanel>
                                                    </DataTemplate>
                                                </ListBox.ItemTemplate>
                                            </ListBox>
                                        </StackPanel>
                                    </ScrollViewer>
                                </Border>
                                <StackPanel Grid.Column="2">
                                    <Button x:Name="PopupShowDocBTN" Content="مشاهده فایل" Cursor="Hand" Width="90" Margin="0 10 -10 0" IsEnabled="False" Click="PopupShowDocBTN_Click" Height="34" />
                                </StackPanel>
                            </Grid>
                        </WrapPanel>
                        <WrapPanel Margin="0 10">
                            <CheckBox x:Name="PopupPaymentStatusCheckBox" IsEnabled="False" Content="تسویه شده؟" Cursor="Hand" FontSize="13" Margin="0,0,10,0" Checked="PopupPaymentStatusCheckBox_Checked" Unchecked="PopupPaymentStatusCheckBox_Unchecked"/>
                            <TextBlock Text="مبلغ پرداخت شده:" Margin="5 3"/>
                            <TextBox x:Name="PopupAmountTB" IsEnabled="False" FontSize="14" Width="200" TextChanged="PopupAmountTB_TextChanged"/>
                        </WrapPanel>
                        <WrapPanel Margin="0 10">
                            <CheckBox x:Name="PopupReminderSetCheckBox" IsEnabled="False" Content="تنظیم یادآوری؟" Cursor="Hand" FontSize="13" Margin="0,0,10,0" Checked="PopupReminderSetCheckBox_Checked" Unchecked="PopupReminderSetCheckBox_Unchecked"/>
                            <hc:PersianDatePicker x:Name="PopupReminderSetDP" Text="{Binding DueDate}" IsEnabled="False" FontSize="14" Width="200"/>
                        </WrapPanel>
                        <WrapPanel HorizontalAlignment="Right" Margin="0,5,10,380" Width="200">
                            <Button x:Name="PaymentDetailsPopupUpdateBTN" Content="✅ ذخیره ویرایش" Background="#1259D5" Foreground="White" Cursor="Hand" Height="30" Click="PaymentDetailsPopupUpdateBTN_Click"/>
                            <Button x:Name="PaymentDetailsPopupCloseBTN" Content="❌ بستن" Background="Crimson" Foreground="White" Cursor="Hand" Margin="20 0 0 0" Height="30" Click="PaymentDetailsPopupCloseBTN_Click"/>
                        </WrapPanel>
                    </StackPanel>
                </Border>
            </Grid>
            <!-- Tab Control -->
            <TabControl x:Name="MainGrid" Margin="20,60,20,37" FontWeight="Bold">
                <!-- Tab: مدیریت پرداخت ها و صورتحساب ها -->
                <TabItem x:Name="PaymentTab" Header="مدیریت پرداخت ها و صورتحساب ها" Cursor="Hand">
                    <Grid Margin="5">
                        <Grid x:Name="PaymentGrid">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="14*"/>
                                <RowDefinition Height="71*"/>
                            </Grid.RowDefinitions>
                            <Button x:Name="AddPaymentBTN" Cursor="Hand" Background="#4068FA" Foreground="White" Height="35" Margin="20,30,0,0" Click="AddPaymentBTN_Click" HorizontalAlignment="Left" VerticalAlignment="Top">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="افزودن" VerticalAlignment="Center" FontSize="11.5" Margin="-2,0,10,0"/>
                                    <Image Source="Resources/Images/Add.png" Width="23" Height="23"/>
                                </StackPanel>
                            </Button>
                            <!-- Preview Area -->
                            <FlowDocumentScrollViewer x:Name="InvoiceGenerate" Visibility="Collapsed" Grid.Row="1" HorizontalAlignment="Left" Margin="0,74,0,0" />
                            <Button x:Name="PrintInvoiceBTN" IsEnabled="False" Cursor="Hand" Background="ForestGreen" Foreground="White" Height="35" Margin="122,30,0,0" Click="PrintInvoiceBTN_Click" Width="144" VerticalAlignment="Top" HorizontalAlignment="Left">
                                <StackPanel Orientation="Horizontal" Width="122">
                                    <TextBlock Text="تولید صورتحساب" VerticalAlignment="Center" FontSize="11.5" Margin="-2,0,10,0" Width="83"/>
                                    <Image Source="Resources/Images/Print.png" Stretch="Fill" Width="35" Height="30" Margin="-5,-3,0,0"/>
                                </StackPanel>
                            </Button>
                            <hc:SearchBar x:Name="SearchBox" HorizontalAlignment="Right" Margin="0,35,225,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="300" TextChanged="SearchBox_TextChanged"/>
                            <TextBlock x:Name="SearchPlaceholderText"
                              Text="جستجو براساس نام موکل یا موضوع پرونده ..."
                              Foreground="Gray" FontWeight="Regular"                                         
                              IsHitTestVisible="False" HorizontalAlignment="Right" Margin="0,38,300,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="220"/>
                            <Image Source="Resources/Images/Heyam_Blue.png" Height="60" Width="61" VerticalAlignment="Top" HorizontalAlignment="Right" Margin="0,5,34,0"/>
                        </Grid>
                        <!-- Payment List -->
                        <GroupBox Header="لیست پرداخت‌ها" Margin="20,75,20,10" Background="White" BorderBrush="#ccc" BorderThickness="1" Grid.RowSpan="2">
                            <DataGrid x:Name="PaymentDGV" AutoGenerateColumns="False" IsReadOnly="True" Margin="10,32,10,0" Height="350" SelectionChanged="PaymentDGV_SelectionChanged">
                                <DataGrid.Columns>
                                    <DataGridTemplateColumn Header="کاربر" Width="55">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding UserTypeText}" Foreground="{Binding UserTypeColor}" />
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    <DataGridTextColumn Header="نام موکل" Binding="{Binding ClientName}" Width="140"/>
                                    <DataGridTextColumn Header="تلفن همراه" Binding="{Binding ClientPhoneNumber}" Width="110"/>
                                    <DataGridTextColumn Visibility="Collapsed" Header="شماره پرونده" Binding="{Binding ClientCaseNumber}" Width="100"/>
                                    <DataGridTextColumn Visibility="Collapsed" Header="هزینه پرداختی" Binding="{Binding Cost}" Width="100"/>
                                    <DataGridTextColumn Header="موضوع پرونده" Binding="{Binding ClientCaseSubject}" Width="120"/>
                                    <DataGridTemplateColumn Header="نوع خدمت" Width="95">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding ServiceTypeText}" Foreground="{Binding ServiceTypeColor}" />
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    <DataGridTemplateColumn Header="وضعیت" Width="95">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding PaymentStatusTypeText}" Foreground="{Binding PaymentStatusTypeColor}" />
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    <DataGridTextColumn Header="یادآوری؟" Binding="{Binding IsReminderSet}" Width="80"/>
                                    <!-- ستون دکمه نمایش جزئیات -->
                                    <DataGridTemplateColumn Header="جزئیات" Width="*">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button x:Name="ShowPaymentsDetailsBTN" Content="👁 مشاهده" 
                                                 Tag="{Binding Id}" Cursor="Hand" Click="ShowPaymentsDetailsBTN_Click" />
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </GroupBox>
                        <TextBlock x:Name="ReminderFilterText" Text="فیلتر براساس وضعیت پرداختی:" FontSize="12" FontWeight="Bold" Foreground="DarkBlue" Margin="464,119,214,368"/>
                        <ComboBox x:Name="ReminderFilterCB" SelectedValuePath="Tag"
                                 Margin="629,113,40,366" FlowDirection="RightToLeft" SelectionChanged="ReminderFilterCB_SelectionChanged">
                            <ComboBoxItem Content="همه" Tag="" IsSelected="True" />
                            <ComboBoxItem Content="پیش پرداختی ها" Tag="0"/>
                            <ComboBoxItem Content="تسفیه شده ها" Tag="1"/>
                        </ComboBox>
                        <!-- Summary Section -->
                        <WrapPanel VerticalAlignment="Bottom" HorizontalAlignment="Left" Margin="35,0,0,-9">
                            <TextBlock Text=" تعداد رکوردها: " FontWeight="Bold"/>
                            <TextBlock x:Name="PaymentTotalRecordsText" Foreground="DarkRed" Margin="5,0"/>
                            <TextBlock Text="| مجموع پرداخت‌شده: " FontWeight="Bold" />
                            <TextBlock x:Name="PaymentTotalPaidText" Foreground="#1259D5" Width="180"/>
                        </WrapPanel>
                    </Grid>
                </TabItem>

                <!-- Tab: مدیریت هزینه های وکیل -->
                <TabItem x:Name="ExpenseTab" Header="مدیریت هزینه های وکیل" Cursor="Hand">
                    <Grid Margin="5">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <!-- فرم ثبت -->
                            <RowDefinition Height="*"/>
                            <!-- لیست -->
                            <RowDefinition Height="Auto"/>
                            <!-- مجموع -->
                        </Grid.RowDefinitions>

                        <!-- فرم ثبت هزینه -->
                        <GroupBox Header="ثبت هزینه جدید" FontWeight="Bold" Padding="10" Margin="0 0 0 10">
                            <Grid x:Name="ExpensePanel">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="0.7*"/>
                                    <ColumnDefinition Width="0.7*"/>
                                    <ColumnDefinition Width="0.7*"/>
                                    <ColumnDefinition Width="0.7*"/>
                                    <ColumnDefinition Width="0.7*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <!-- عنوان هزینه -->
                                <StackPanel Margin="5" Orientation="Vertical">
                                    <TextBlock Text="عنوان هزینه:"/>
                                    <TextBox x:Name="ExpenseTitleTB"/>
                                </StackPanel>

                                <!-- مبلغ -->
                                <StackPanel Margin="5" Orientation="Vertical" Grid.Column="1">
                                    <TextBlock Text="مبلغ (ریال):"/>
                                    <TextBox x:Name="ExpenseAmountTB" TextChanged="ExpenseAmountTB_TextChanged"/>
                                </StackPanel>

                                <!-- تاریخ -->
                                <StackPanel Margin="5" Orientation="Vertical" Grid.Column="2">
                                    <TextBlock Text="تاریخ:"/>
                                    <hc:PersianDatePicker x:Name="ExpenseDP"/>
                                </StackPanel>

                                <!-- نوع هزینه -->
                                <StackPanel Margin="5" Orientation="Vertical" Grid.Column="3">
                                    <TextBlock Text="نوع هزینه:"/>
                                    <ComboBox x:Name="ExpenseTypeCB" SelectedIndex="0">
                                        <ComboBoxItem>اداری</ComboBoxItem>
                                        <ComboBoxItem>دادرسی</ComboBoxItem>
                                        <ComboBoxItem>حمل‌ونقل</ComboBoxItem>
                                        <ComboBoxItem>مشاوره</ComboBoxItem>
                                        <ComboBoxItem>غیره</ComboBoxItem>
                                    </ComboBox>
                                </StackPanel>

                                <!-- عنوان هزینه -->
                                <StackPanel Margin="5" Orientation="Vertical" Grid.Column="4">
                                    <TextBlock Text="توضیحات:"/>
                                    <Button x:Name="ExpenseDescriptionBTN" Content="ورود به پنجره توضیحات" Cursor="Hand" Background="Gold" Click="ExpenseDescriptionBTN_Click"/>
                                </StackPanel>
                                <!-- دکمه ثبت -->
                                <Button x:Name="AddExpenseBTN" Content="ثبت هزینه" Cursor="Hand" Background="#1259D5" Foreground="White" Grid.Column="5" Margin="0,25,0,0" Padding="10,5"
                                 Click="AddExpenseBTN_Click" VerticalAlignment="Top" Height="30"/>
                            </Grid>
                        </GroupBox>

                        <!-- لیست هزینه‌ها -->
                        <DataGrid x:Name="ExpensesDGV" Grid.Row="1" AutoGenerateColumns="False"
                        Margin="0 10" IsReadOnly="True" SelectionMode="Single">
                            <DataGrid.Columns>
                                <DataGridTemplateColumn Header="کاربر" Width="55">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding UserTypeText}" Foreground="{Binding UserTypeColor}" />
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTextColumn Header="عنوان هزینه" Binding="{Binding Title}" Width="*"/>
                                <DataGridTextColumn Header="مبلغ" Binding="{Binding Amount, StringFormat={}{0:N0} ريال}" Width="*"/>
                                <DataGridTextColumn Header="تاریخ" Binding="{Binding SetDateShamsi}" Width="*"/>
                                <DataGridTextColumn Header="نوع هزینه" Binding="{Binding ExpenseType}" Width="*"/>
                                <!--<DataGridTextColumn Header="شرح" Binding="{Binding Description}" Width="2*"/>-->
                                <!-- ستون دکمه نمایش جزئیات -->
                                <DataGridTemplateColumn Header="شرح" Width="*">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Button x:Name="ShowExpenseDescriptionBTN" Content="👁 مشاهده توضیحات" 
                                            Tag="{Binding Id}" Cursor="Hand" Click="ShowExpenseDescriptionBTN_Click" />
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>

                        <!-- مجموع -->
                        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Left" Margin="0 10 0 0" Width="300">
                            <TextBlock Text="تعداد کل رکوردها: " FontWeight="Bold" VerticalAlignment="Center"/>
                            <TextBlock x:Name="ExpenseTotalCountText" Foreground="DarkRed" Margin="5,0"/>
                            <TextBlock Text=" | مجموع مبلغ: " FontWeight="Bold" VerticalAlignment="Center"/>
                            <TextBlock x:Name="ExpenseTotalAmountText" Foreground="#1259D5" Margin="5,0"/>
                        </StackPanel>
                    </Grid>
                </TabItem>

                <!-- Tab: بودجه بندی و پیش بینی مالی -->
                <TabItem Header="بودجه بندی و پیش بینی مالی" Cursor="Hand" Height="31" VerticalAlignment="Top">
                    <Grid Background="White" Margin="0 15 0 0">
                        <TextBlock x:Name="TutorialTextBlock" Text="در حال بروزرسانی" HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="32" FontWeight="Heavy" Foreground="#1754E1"/>
                        <Image Source="Resources/Images/updated.png" Height="72" Width="62" VerticalAlignment="Top" HorizontalAlignment="Center" Margin="0,295,0,0"/>
                    </Grid>
                </TabItem>

                <!-- Tab: گزارش گیری مالی -->
                <TabItem Header="گزارش گیری مالی" Cursor="Hand">
                    <Grid Background="White" Height="505">
                        <!-- Header -->
                        <DockPanel Background="#3E4A61" Height="50">
                            <TextBlock Text="گزارش‌گیری مالی" Foreground="White" 
                            FontSize="18" VerticalAlignment="Center"
                            HorizontalAlignment="Center" FontWeight="Bold"/>
                        </DockPanel>

                        <!-- Main Content -->
                        <Grid Margin="0 15 0 0">
                            <TabControl Name="ReportsTabControl">
                                <!-- نمودار درآمد و هزینه -->
                                <TabItem x:Name="IncomeAndCostChart" Header="درآمد و هزینه" Margin="250,0,-253,0">
                                    <Grid Margin="10" FlowDirection="LeftToRight">
                                        <GroupBox Header="نمایش کل درآمدها و هزینه ها"  Margin="0,10,0,-10">
                                            <lvc:CartesianChart Name="ReportChart" Margin="20,20,20,36">
                                                <lvc:CartesianChart.AxisX>
                                                    <lvc:Axis Title="ماه‌ها" Labels="{Binding Labels}" FontFamily="pack://application:,,,/Resources/Fonts/#IRANSansWeb(FaNum)" />
                                                </lvc:CartesianChart.AxisX>
                                                <lvc:CartesianChart.AxisY>
                                                    <lvc:Axis Title="(مبالغ (ریال" FontFamily="pack://application:,,,/Resources/Fonts/#IRANSansWeb(FaNum)" />
                                                </lvc:CartesianChart.AxisY>
                                            </lvc:CartesianChart>
                                        </GroupBox>
                                        <WrapPanel>
                                            <!-- فیلتر بازه زمانی -->
                                            <ComboBox x:Name="TimeRangeCB" Cursor="Hand" Width="94" Margin="360 50" HorizontalContentAlignment="Center" SelectionChanged="TimeRangeCB_SelectionChanged">
                                                <ComboBoxItem Content="روزانه"/>
                                                <ComboBoxItem Content="ماهانه" IsSelected="True"/>
                                                <ComboBoxItem Content="سالانه"/>
                                            </ComboBox>
                                        </WrapPanel>
                                        <WrapPanel x:Name="YearRangeWP" IsEnabled="False" HorizontalAlignment="Left" Margin="360,398,0,0" FlowDirection="RightToLeft" Width="461" Height="50" VerticalAlignment="Top">
                                            <TextBlock Text="از سال:" VerticalAlignment="Center" />
                                            <ComboBox x:Name="YearFromCB" IsEditable="True" Width="75" Height="20"/>
                                            <TextBlock Text="تا سال:" VerticalAlignment="Center" />
                                            <ComboBox x:Name="YearToCB" IsEditable="True" Width="75" Height="20"/>
                                            <Button x:Name="YearlyChartBTN" Content="نمایش گزارش سالانه" Click="YearlyChartBTN_Click" Background="Gold" Foreground="Black" Margin="10"/>
                                        </WrapPanel>
                                        <Button Name="PrintChartReportBTN" Content="چاپ گزارش" Background="ForestGreen" Foreground="White" Cursor="Hand" Margin="10,407,0,0" Width="120" Height="30" Click="PrintChartReportBTN_Click" HorizontalAlignment="Left" VerticalAlignment="Top"/>
                                    </Grid>
                                </TabItem>
                                <!-- قراردادها و پرداخت‌ها -->
                                <TabItem Header="قراردادها" Margin="253,0,-252,0">
                                    <Grid Margin="10">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="245*"/>
                                            <RowDefinition Height="37*"/>
                                        </Grid.RowDefinitions>
                                        <!-- Filters Section -->
                                        <WrapPanel Margin="0,10,0,334">
                                            <TextBox x:Name="ContractSearchClient" Width="200" Margin="0,0,10,0" TextChanged="ContractSearchClient_TextChanged" />
                                            <TextBlock x:Name="ClientNamePlaceholderText" Text="نام موکل ..." IsHitTestVisible="False" Foreground="Gray" FontSize="11" HorizontalAlignment="Left" Margin="-200,5,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="75"/>
                                            <hc:PersianDatePicker x:Name="ContractStartDP" Width="200" Margin="0,0,10,0" SelectedDateChanged="ContractStartDP_SelectedDateChanged"/>
                                            <TextBlock x:Name="ContractStartPlaceholderText" Text="از بازه زمانی ..." IsHitTestVisible="False" Foreground="Gray" FontSize="11" HorizontalAlignment="Left" Margin="-200,5,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="75"/>
                                            <hc:PersianDatePicker x:Name="ContractEndDP" Width="200" Margin="0,0,10,0" SelectedDateChanged="ContractEndDP_SelectedDateChanged"/>
                                            <TextBlock x:Name="ContractEndPlaceholderText" Text="تا بازه زمانی ..." IsHitTestVisible="False" Foreground="Gray" FontSize="11" HorizontalAlignment="Left" Margin="-200,5,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="75"/>
                                            <Button x:Name="DateFilterBTN" Content="فیلتر" Background="#1259D5" Foreground="White" Width="60" Click="DateFilterBTN_Click" />
                                        </WrapPanel>

                                        <!-- جدول اطلاعات موکل‌ها -->
                                        <DataGrid x:Name="ReportContractsDGV" AutoGenerateColumns="False" IsReadOnly="True" CanUserResizeColumns="True" Margin="0,52,0,50" Grid.RowSpan="2">
                                            <DataGrid.Columns>
                                                <DataGridTemplateColumn Header="کاربر" Width="55">
                                                    <DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <TextBlock Text="{Binding UserTypeText}" Foreground="{Binding UserTypeColor}" />
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellTemplate>
                                                </DataGridTemplateColumn>
                                                <DataGridTextColumn Header="نام موکل" Binding="{Binding ClientName}" Width="*"/>
                                                <DataGridTextColumn Header="شماره پرونده" Binding="{Binding CaseNumber}" Width="150"/>
                                                <DataGridTextColumn Visibility="Visible" Header="موضوع پرونده" Binding="{Binding CaseSubject}" Width="*"/>
                                                <DataGridTemplateColumn Header="نوع قرارداد" Width="*">
                                                    <DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <TextBlock Text="{Binding ContractTypeText}" Foreground="{Binding ContractTypeColor}" />
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellTemplate>
                                                </DataGridTemplateColumn>
                                                <DataGridTextColumn Header="مبلغ حق الوکاله" Binding="{Binding TotalAmountFormat}" Width="*"/>
                                                <DataGridTextColumn Header="تاریخ تنظیم" Binding="{Binding SetDateShamsi}" Width="*"/>
                                            </DataGrid.Columns>
                                        </DataGrid>

                                        <!-- Summary Section -->
                                        <WrapPanel VerticalAlignment="Bottom" HorizontalAlignment="Left" Grid.Row="1" Margin="0,0,0,10" >
                                            <TextBlock Text=" تعداد رکوردها: " FontWeight="Bold"/>
                                            <TextBlock x:Name="TotalRecordsText" Foreground="DarkRed"  Margin="5,0"/>
                                            <TextBlock Text="| مجموع پرداخت‌شده: " FontWeight="Bold" />
                                            <TextBlock x:Name="TotalPaidText" Foreground="#1259D5" Width="180"/>
                                        </WrapPanel>
                                        <!-- Preview Area -->
                                        <FlowDocumentScrollViewer x:Name="ContractsReportGenerate" Visibility="Collapsed" Grid.Row="1" HorizontalAlignment="Left" Margin="0,74,0,0" />
                                        <Button Name="PrintContractReportBTN" Content="🖨 چاپ و پرینت اطلاعات" Background="Green" Foreground="White" Cursor="Hand"  Margin="629,16,0,0" Width="157" Height="30" Click="PrintContractReportBTN_Click" HorizontalAlignment="Left" VerticalAlignment="Top" Grid.Row="1"/>
                                    </Grid>
                                </TabItem>

                                <!--درآمدها -->
                                <TabItem Header="درآمدها" Margin="253,0,-252,0">
                                    <Grid Margin="10">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="245*"/>
                                            <RowDefinition Height="37*"/>
                                        </Grid.RowDefinitions>
                                        <!-- Filters Section -->
                                        <WrapPanel Margin="0,10,0,334">
                                            <TextBox x:Name="PaymentReportSearchClient" Width="200" Margin="0,0,10,0" TextChanged="PaymentReportSearchClient_TextChanged" />
                                            <TextBlock x:Name="PaymentReportClientNamePlaceholderText" Text="نام موکل ..." IsHitTestVisible="False" Foreground="Gray" FontSize="11" HorizontalAlignment="Left" Margin="-200,5,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="75"/>
                                            <hc:PersianDatePicker x:Name="PaymentStartDP" Width="200" Margin="0,0,10,0" SelectedDateChanged="PaymentStartDP_SelectedDateChanged"/>
                                            <TextBlock x:Name="PaymentStartPlaceholderText" Text="از بازه زمانی ..." IsHitTestVisible="False" Foreground="Gray" FontSize="11" HorizontalAlignment="Left" Margin="-200,5,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="75"/>
                                            <hc:PersianDatePicker x:Name="PaymentEndDP" Width="200" Margin="0,0,10,0" SelectedDateChanged="PaymentEndDP_SelectedDateChanged"/>
                                            <TextBlock x:Name="PaymentEndPlaceholderText" Text="تا بازه زمانی ..." IsHitTestVisible="False" Foreground="Gray" FontSize="11" HorizontalAlignment="Left" Margin="-200,5,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="75"/>
                                            <Button x:Name="PaymentDateFilterBTN" Content="فیلتر" Background="#1259D5" Foreground="White" Width="60" Click="PaymentDateFilterBTN_Click" />
                                            <ComboBox x:Name="PaymentReportStatusCB" Visibility="Collapsed" Width="125" Margin="0,0,10,0" SelectionChanged="PaymentReportStatusCB_SelectionChanged">
                                                <ComboBoxItem Content="همه وضعیت‌ها" Tag="" IsSelected="True" />
                                                <ComboBoxItem Content="پیش پرداخت" Tag="0" />
                                                <ComboBoxItem Content="تسویه شده" Tag="1" />
                                            </ComboBox>
                                        </WrapPanel>

                                        <!-- جدول اطلاعات موکل‌ها -->
                                        <DataGrid x:Name="PaymentReportDGV" AutoGenerateColumns="False" IsReadOnly="True" CanUserResizeColumns="True" Margin="0,52,0,50" Grid.RowSpan="2">
                                            <DataGrid.Columns>
                                                <DataGridTemplateColumn Header="کاربر" Width="55">
                                                    <DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <TextBlock Text="{Binding UserTypeText}" Foreground="{Binding UserTypeColor}" />
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellTemplate>
                                                </DataGridTemplateColumn>
                                                <DataGridTextColumn Header="نام موکل" Binding="{Binding ClientName}" Width="*"/>
                                                <DataGridTextColumn Header="تلفن همراه" Binding="{Binding ClientPhoneNumber}" Width="*"/>
                                                <DataGridTextColumn Visibility="Collapsed" Header="شماره پرونده" Binding="{Binding ClientCaseNumber}" Width="*"/>
                                                <DataGridTextColumn Visibility="Collapsed" Header="روش پرداخت" Binding="{Binding PaymentType}" Width="*"/>
                                                <DataGridTextColumn Visibility="Collapsed" Header="مبلغ" Binding="{Binding Amount}" Width="*"/>
                                                <DataGridTextColumn Header="موضوع پرونده" Binding="{Binding ClientCaseSubject}" Width="*"/>
                                                <DataGridTemplateColumn Header="نوع خدمت" Width="*">
                                                    <DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <TextBlock Text="{Binding ServiceTypeText}" Foreground="{Binding ServiceTypeColor}" />
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellTemplate>
                                                </DataGridTemplateColumn>
                                                <DataGridTemplateColumn Header="وضعیت" Width="*">
                                                    <DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <TextBlock Text="{Binding PaymentStatusTypeText}" Foreground="{Binding PaymentStatusTypeColor}" />
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellTemplate>
                                                </DataGridTemplateColumn>
                                                <DataGridTextColumn Visibility="Visible" Header="تاریخ پرداخت" Binding="{Binding SetDateShamsi}" Width="*"/>
                                                <!-- ستون دکمه نمایش جزئیات -->
                                                <DataGridTemplateColumn Header="جزئیات" Width="*">
                                                    <DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <Button x:Name="ShowReportPaymentsDetailsBTN" Content="👁 مشاهده" 
                                                            Tag="{Binding Id}" Cursor="Hand" Click="ShowReportPaymentsDetailsBTN_Click" />
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellTemplate>
                                                </DataGridTemplateColumn>
                                            </DataGrid.Columns>
                                        </DataGrid>

                                        <!-- Summary Section -->
                                        <WrapPanel VerticalAlignment="Bottom" HorizontalAlignment="Left" Grid.Row="1" Margin="0,0,0,10">
                                            <TextBlock Text=" تعداد رکوردها: " FontWeight="Bold"/>
                                            <TextBlock x:Name="PaymentReportTotalRecordsText" Foreground="DarkRed"  Margin="5,0"/>
                                            <TextBlock Text="| مجموع پرداخت‌شده: " FontWeight="Bold" />
                                            <TextBlock x:Name="PaymentReportTotalPaidText" Foreground="#1259D5" Width="180"/>
                                        </WrapPanel>
                                        <!-- Preview Area -->
                                        <FlowDocumentScrollViewer x:Name="PaymentReportGenerate" Visibility="Collapsed" Grid.Row="1" HorizontalAlignment="Left" Margin="0,74,0,0" />
                                        <Button Name="PrintPaymentReportBTN" Content="🖨 چاپ و پرینت اطلاعات" Background="Green" Foreground="White" Cursor="Hand"  Margin="629,16,0,0" Width="157" Height="30" Click="PrintPaymentReportBTN_Click" HorizontalAlignment="Left" VerticalAlignment="Top" Grid.Row="1"/>
                                    </Grid>
                                </TabItem>

                                <!--هزینه ها -->
                                <TabItem Header="هزینه ها" Margin="253,0,-252,0">
                                    <Grid Margin="10">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="245*"/>
                                            <RowDefinition Height="37*"/>
                                        </Grid.RowDefinitions>
                                        <!-- Filters Section -->
                                        <WrapPanel Margin="0,10,0,334">
                                            <TextBox x:Name="ExpenseReportSearchClient" Width="200" Margin="0,0,10,0" TextChanged="ExpenseReportSearchClient_TextChanged" />
                                            <TextBlock x:Name="ExpenseReportClientNamePlaceholderText" Text="نام موکل ..." IsHitTestVisible="False" Foreground="Gray" FontSize="11" HorizontalAlignment="Left" Margin="-200,5,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="75"/>
                                            <hc:PersianDatePicker x:Name="ExpenseStartDP" Width="200" Margin="0,0,10,0" SelectedDateChanged="ExpenseStartDP_SelectedDateChanged"/>
                                            <TextBlock x:Name="ExpenseStartPlaceholderText" Text="از بازه زمانی ..." IsHitTestVisible="False" Foreground="Gray" FontSize="11" HorizontalAlignment="Left" Margin="-200,5,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="75"/>
                                            <hc:PersianDatePicker x:Name="ExpenseEndDP" Width="200" Margin="0,0,10,0" SelectedDateChanged="ExpenseEndDP_SelectedDateChanged"/>
                                            <TextBlock x:Name="ExpenseEndPlaceholderText" Text="تا بازه زمانی ..." IsHitTestVisible="False" Foreground="Gray" FontSize="11" HorizontalAlignment="Left" Margin="-200,5,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="75"/>
                                            <Button x:Name="ExpenseDateFilterBTN" Content="فیلتر" Background="#1259D5" Foreground="White" Width="60" Click="ExpenseDateFilterBTN_Click" />
                                        </WrapPanel>

                                        <!-- لیست هزینه‌ها -->
                                        <DataGrid x:Name="ReportExpensesDGV" AutoGenerateColumns="False"
                                         Margin="0,47,0,47" IsReadOnly="True" SelectionMode="Single" Grid.RowSpan="2">
                                            <DataGrid.Columns>
                                                <DataGridTemplateColumn Header="کاربر" Width="55">
                                                    <DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <TextBlock Text="{Binding UserTypeText}" Foreground="{Binding UserTypeColor}" />
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellTemplate>
                                                </DataGridTemplateColumn>
                                                <DataGridTextColumn Header="عنوان هزینه" Binding="{Binding Title}" Width="*"/>
                                                <DataGridTextColumn Header="مبلغ" Binding="{Binding Amount, StringFormat={}{0:N0} ريال}" Width="*"/>
                                                <DataGridTextColumn Header="تاریخ" Binding="{Binding SetDateShamsi}" Width="*"/>
                                                <DataGridTextColumn Header="نوع هزینه" Binding="{Binding ExpenseType}" Width="*"/>
                                                <!--<DataGridTextColumn Header="شرح" Binding="{Binding Description}" Width="2*"/>-->
                                                <!-- ستون دکمه نمایش جزئیات -->
                                                <DataGridTemplateColumn Header="شرح" Width="*">
                                                    <DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <Button x:Name="ShowReportExpenseDescriptionBTN" Content="👁 مشاهده توضیحات" 
                                                            Tag="{Binding Id}" Cursor="Hand" Click="ShowReportExpenseDescriptionBTN_Click" />
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellTemplate>
                                                </DataGridTemplateColumn>
                                            </DataGrid.Columns>
                                        </DataGrid>

                                        <!-- مجموع -->
                                        <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Left" Margin="0 10 0 0" Width="300">
                                            <TextBlock Text="تعداد کل رکوردها: " FontWeight="Bold" VerticalAlignment="Center"/>
                                            <TextBlock x:Name="ReportExpenseTotalCountText" Foreground="DarkRed" Margin="10,14"/>
                                            <TextBlock Text=" | مجموع مبلغ: " FontWeight="Bold" VerticalAlignment="Center"/>
                                            <TextBlock x:Name="ReportExpenseTotalAmountText" Foreground="#1259D5" Margin="5,14" Width="180"/>
                                        </StackPanel>
                                        <!-- Preview Area -->
                                        <FlowDocumentScrollViewer x:Name="ExpenseReportGenerate" Visibility="Collapsed" Grid.Row="1" HorizontalAlignment="Left" Margin="0,74,0,0" />
                                        <Button Name="PrintExpenseReportBTN" Content="🖨 چاپ و پرینت اطلاعات" Background="Green" Foreground="White" Cursor="Hand"  Margin="629,16,0,0" Width="157" Height="30" HorizontalAlignment="Left" VerticalAlignment="Top" Grid.Row="1" Click="PrintExpenseReportBTN_Click"/>
                                    </Grid>
                                </TabItem>
                            </TabControl>
                        </Grid>
                        <FlowDocumentReader Visibility="Collapsed">
                            <FlowDocument FlowDirection="RightToLeft">
                                <Paragraph TextAlignment="Center">
                                    <!--متن فارسی شما اینجاست-->
                                </Paragraph>
                            </FlowDocument>
                        </FlowDocumentReader>
                    </Grid>
                </TabItem>
            </TabControl>

            <!-- اضاف کردن توضیحات -->
            <Grid x:Name="ExpenseDescription" Visibility="Collapsed"
                  HorizontalAlignment="Center" VerticalAlignment="Top"
                  Height="310"
                  Width="450" Panel.ZIndex="99">
                <Border Background="White" Padding="15" CornerRadius="10" BorderBrush="Black" BorderThickness="3" Width="440" Height="300">
                    <StackPanel>
                        <TextBlock Text="📜 توضیحات" FontSize="18" FontWeight="Bold" Foreground="DarkBlue" Margin="0,0,0,10"/>
                        <TextBox x:Name="ExpenseDescriptionTB" Margin="0,0,0,40" Height="180" TextWrapping="Wrap" VerticalContentAlignment="Top" VerticalScrollBarVisibility="Visible"/>
                        <WrapPanel HorizontalAlignment="Right" Margin="0,11,0,0" Width="100">
                            <Button x:Name="ExpenseDescriptionCloseBTN" Content="❌ بستن" Background="Crimson" Foreground="White" Cursor="Hand" Margin="25 -50 0 0" Height="30" Click="ExpenseDescriptionCloseBTN_Click"/>
                        </WrapPanel>
                    </StackPanel>
                </Border>
            </Grid>

            <!-- مشاهده توضیحات -->
            <Grid x:Name="PopupExpenseDescription" Visibility="Collapsed"
                 HorizontalAlignment="Center" VerticalAlignment="Top"
                 Height="310"
                 Width="450" Panel.ZIndex="99">
                <Border Background="White" Padding="15" CornerRadius="10" BorderBrush="Black" BorderThickness="3" Width="440" Height="300">
                    <StackPanel>
                        <TextBlock Text="📜 توضیحات" FontSize="18" FontWeight="Bold" Foreground="DarkBlue" Margin="0,0,0,10"/>
                        <TextBox x:Name="PopupExpenseDescriptionTB" IsReadOnly="True" Margin="0,0,0,40" Height="180" TextWrapping="Wrap" VerticalContentAlignment="Top" VerticalScrollBarVisibility="Visible"/>
                        <WrapPanel HorizontalAlignment="Right" Margin="0,11,0,0" Width="100">
                            <Button x:Name="PopupExpenseDescriptionCloseBTN" Content="❌ بستن" Background="Crimson" Foreground="White" Cursor="Hand" Margin="25 -50 0 0" Height="30" Click="PopupExpenseDescriptionCloseBTN_Click"/>
                        </WrapPanel>
                    </StackPanel>
                </Border>
            </Grid>
            <Button x:Name="CloseBTN" Background="#4068FA" Foreground="White" FontWeight="Bold" Content="برگشت" Width="75" Height="31" Cursor="Hand" Margin="0,0,20,1" VerticalAlignment="Bottom" HorizontalAlignment="Right" Click="CloseBTN_Click" />
        </Grid>
    </Border>
</Window>
